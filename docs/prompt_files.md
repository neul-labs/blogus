# .prompt File Format

Blogus stores prompts in `.prompt` files - YAML frontmatter plus template content.

## Basic Structure

```yaml
---
name: my-prompt
description: What this prompt does
model:
  id: gpt-4o
---

Your prompt content here.
```

## Complete Example

```yaml
---
name: code-review
description: Review code for quality, bugs, and best practices
author: team
category: development
tags:
  - code
  - review
model:
  id: gpt-4o
  temperature: 0.3
  max_tokens: 2000
variables:
  - name: language
    description: Programming language
    required: true
  - name: code
    description: Code to review
    required: true
  - name: focus
    description: Areas to focus on
    required: false
    default: "bugs, performance, readability"
---

Review this {{language}} code:

```{{language}}
{{code}}
```

Focus on: {{focus}}

Provide specific, actionable feedback with line references.
```

## Metadata Fields

### Required

| Field | Type | Description |
|-------|------|-------------|
| `name` | string | Unique identifier (used in `@blogus:name` markers) |

### Optional

| Field | Type | Default | Description |
|-------|------|---------|-------------|
| `description` | string | "" | Human-readable description |
| `author` | string | "" | Prompt author |
| `category` | string | "general" | For organization |
| `tags` | list | [] | For filtering |
| `model` | object | {} | Model configuration |
| `variables` | list | [] | Template variables |

### Model Configuration

```yaml
model:
  id: gpt-4o              # Required: model identifier
  temperature: 0.7        # Optional: 0.0-2.0
  max_tokens: 1000        # Optional: output limit
  top_p: 1.0              # Optional: nucleus sampling
```

### Variable Definition

```yaml
variables:
  - name: input           # Required: variable name
    description: "..."    # Required: what it's for
    required: true        # Optional: default true
    default: "..."        # Optional: default value
    enum:                 # Optional: allowed values
      - option1
      - option2
```

## Template Syntax

Use `{{variable}}` for substitution:

```yaml
---
name: translator
variables:
  - name: source_lang
    required: true
  - name: target_lang
    required: true
  - name: text
    required: true
---

Translate from {{source_lang}} to {{target_lang}}:

{{text}}
```

Execute with:
```bash
blogus exec translator \
  --var source_lang=English \
  --var target_lang=French \
  --var text="Hello world"
```

## File Organization

Recommended structure:
```
project/
├── prompts/
│   ├── summarize.prompt
│   ├── code-review.prompt
│   ├── translate.prompt
│   └── category/
│       └── specific.prompt
├── prompts.lock
└── src/
    └── ...
```

Naming conventions:
- Lowercase with hyphens: `my-prompt.prompt`
- Descriptive but concise
- Use subdirectories for categories

## Lock File

Generated by `blogus lock`:

```yaml
# prompts.lock
version: 1
generated: 2024-01-15T10:30:00Z
prompts:
  summarize:
    hash: sha256:a1b2c3d4e5f6...
    commit: 4903f76
    path: prompts/summarize.prompt
  code-review:
    hash: sha256:b2c3d4e5f6a7...
    commit: 4903f76
    path: prompts/code-review.prompt
```

The hash is computed from the prompt content (frontmatter + template).

## Version Markers

Link code to prompts with markers:

```python
# @blogus:summarize@v3 sha256:a1b2c3d4
response = client.chat.completions.create(
    model="gpt-4o",
    messages=[{"role": "user", "content": load_prompt("summarize", text=text)}]
)
```

Marker format: `@blogus:<name>@<version> sha256:<hash>`

## Git Integration

Prompts are tracked in Git like any other source file:

```bash
# View history
git log --oneline prompts/summarize.prompt

# See changes
git diff prompts/

# Commit updates
git add prompts/ && git commit -m "Improve summarize prompt"
```

After editing, regenerate the lock file:
```bash
blogus lock
git add prompts.lock && git commit -m "Update lock file"
```
